<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='img/favicon.ico') }}"
    />
    <title>{% block title %}Audio Guestbook{% endblock %}</title>
    <link
      href="{{ url_for('static', filename='css/output.min.css') }}"
      rel="stylesheet"
    />
    <script
      src="{{ url_for('static', filename='js/theme.js') }}"
      defer
    ></script>
    {% block extra_head %}{% endblock %}
  </head>
  <body
    class="bg-background text-text dark:bg-dark-background dark:text-dark-text transition-colors duration-300"
  >
    <header
      class="bg-primary dark:bg-dark-primary text-text dark:text-dark-text shadow-md"
    >
      <div class="container mx-auto px-4 py-3">
        <div class="flex justify-between items-center">
          <!-- Left Side: Title -->
          <a href="#" class="text-2xl font-bold flex items-center">
            Audio Guestbook
          </a>

          <!-- Right Side: Icons -->
          <nav class="flex items-center space-x-6">
            <!-- Home Icon -->
            <a
              href="{{ url_for('index') }}"
              class="hover:text-accent flex items-center p-2"
              title="Recordings"
            >
              <img
                id="home-icon"
                src="{{ url_for('static', filename='img/home_light.png') }}"
                alt="Recordings"
                class="w-6 h-6"
              />
            </a>

            <!-- Settings Icon -->
            <a
              href="{{ url_for('edit_config') }}"
              class="hover:text-accent flex items-center p-2"
              title="Settings"
            >
              <img
                id="settings-icon"
                src="{{ url_for('static', filename='img/gear_light.png') }}"
                alt="Settings"
                class="w-6 h-6"
              />
            </a>
            <!-- Reboot Icon -->
            <button
              id="reboot-btn"
              class="hover:text-accent flex items-center p-2"
              title="Reboot System"
            >
              <i
                class="fas fa-sync-alt w-6 h-6 flex items-center justify-center text-lg"
              ></i>
            </button>
            <!-- Shutdown Icon -->
            <button
              id="shutdown-btn"
              class="hover:text-accent flex items-center p-2"
              title="Shutdown System"
            >
              <i
                class="fas fa-power-off w-6 h-6 flex items-center justify-center text-lg"
              ></i>
            </button>

            <!-- Theme Switcher Icon -->
            <label
              class="theme-switch relative inline-block w-14 h-6 flex items-center cursor-pointer"
            >
              <input type="checkbox" class="opacity-0 w-0 h-0" />
              <img
                id="theme-icon"
                src="{{ url_for('static', filename='img/sun.png') }}"
                alt="Theme"
                class="cursor-pointer w-6 h-6 transition-transform"
              />
            </label>
          </nav>
        </div>
      </div>
    </header>
    <main class="container mx-auto px-4 py-8">
      {% block content %}{% endblock %}
    </main>

    <script src="{{ url_for('static', filename='js/menu.js') }}"></script>
    <!-- Add global script for reboot/shutdown functionality -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Reboot button event handler
        document
          .getElementById("reboot-btn")
          ?.addEventListener("click", function () {
            if (confirm("Are you sure you want to reboot the system?")) {
              fetch("/reboot", { method: "POST" })
                .then((response) => response.json())
                .then((data) => {
                  if (data.success) {
                    alert("System is rebooting...");
                  } else {
                    alert("Failed to reboot the system.");
                  }
                })
                .catch((error) => {
                  console.error("Error:", error);
                  alert("An error occurred while trying to reboot the system.");
                });
            }
          });

        // Shutdown button event handler
        document
          .getElementById("shutdown-btn")
          ?.addEventListener("click", function () {
            if (confirm("Are you sure you want to shut down the system?")) {
              fetch("/shutdown", { method: "POST" })
                .then((response) => response.json())
                .then((data) => {
                  if (data.success) {
                    alert("System is shutting down...");
                  } else {
                    alert("Failed to shut down the system.");
                  }
                })
                .catch((error) => {
                  console.error("Error:", error);
                  alert(
                    "An error occurred while trying to shut down the system.",
                  );
                });
            }
          });
      });
    </script>
    {% block extra_js %}{% endblock %}
  </body>
</html>
